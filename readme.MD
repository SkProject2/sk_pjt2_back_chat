SK PJT2 Re:Use ì±„íŒ… ì„œë¹„ìŠ¤
ì‹¤ì‹œê°„ ì¤‘ê³ ê±°ë˜ í”Œë«í¼ì„ ìœ„í•œ WebSocket ê¸°ë°˜ ì±„íŒ… ì‹œìŠ¤í…œ

ğŸ“‹ í”„ë¡œì íŠ¸ ê°œìš”
Re:Use ì¤‘ê³ ê±°ë˜ í”Œë«í¼ì˜ ì‹¤ì‹œê°„ ì±„íŒ… ì„œë¹„ìŠ¤ì…ë‹ˆë‹¤. WebSocketê³¼ STOMP í”„ë¡œí† ì½œì„ í™œìš©í•˜ì—¬ êµ¬ë§¤ìì™€ íŒë§¤ì ê°„ ì›í™œí•œ ì†Œí†µì„ ì§€ì›í•˜ë©°, Kafkaë¥¼ í†µí•œ í™•ì¥ ê°€ëŠ¥í•œ ì•„í‚¤í…ì²˜ë¥¼ êµ¬í˜„í–ˆìŠµë‹ˆë‹¤.
ğŸ› ï¸ ê¸°ìˆ  ìŠ¤íƒ
ë°±ì—”ë“œ

Java 17 - ì£¼ìš” ê°œë°œ ì–¸ì–´
Spring Boot 3.4.2 - ì• í”Œë¦¬ì¼€ì´ì…˜ í”„ë ˆì„ì›Œí¬
Spring WebSocket & STOMP - ì‹¤ì‹œê°„ ì–‘ë°©í–¥ í†µì‹ 
Spring Security - ë³´ì•ˆ ì„¤ì •
Spring Data JPA - ë°ì´í„° ì•¡ì„¸ìŠ¤

ë°ì´í„°ë² ì´ìŠ¤

MySQL - ì±„íŒ… ê¸°ë¡ ë° ë°© ì •ë³´ ì €ì¥
Redis - ì‹¤ì‹œê°„ ì°¸ì—¬ì ì„¸ì…˜ ê´€ë¦¬

ë©”ì‹œì§• ì‹œìŠ¤í…œ

Apache Kafka - ë©”ì‹œì§€ í ë° ì„œë²„ ê°„ ë°ì´í„° í†µí•©
Zookeeper - Kafka í´ëŸ¬ìŠ¤í„° ê´€ë¦¬

ì¸í”„ë¼ & ë°°í¬

Docker & Docker Compose - ì»¨í…Œì´ë„ˆí™” í™˜ê²½
GitHub Actions - CI/CD íŒŒì´í”„ë¼ì¸
AWS EC2 - ì„œë²„ ë°°í¬

ê¸°íƒ€

Gradle - ë¹Œë“œ ë„êµ¬
Lombok - ì½”ë“œ ê°„ì†Œí™”
JavaMail - ì´ë©”ì¼ ë¬¸ì˜ ê¸°ëŠ¥

ğŸ—ï¸ ì‹œìŠ¤í…œ ì•„í‚¤í…ì²˜
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   Frontend      â”‚    â”‚   Chat Server   â”‚    â”‚   Message Queue â”‚
â”‚   (WebSocket)   â”‚â—„â”€â”€â–ºâ”‚   (Spring Boot) â”‚â—„â”€â”€â–ºâ”‚     (Kafka)     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                â”‚                        â”‚
                                â–¼                        â–¼
                       â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                       â”‚     MySQL       â”‚    â”‚     Redis       â”‚
                       â”‚  (Chat History) â”‚    â”‚ (Session Store) â”‚
                       â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
ğŸ“ í”„ë¡œì íŠ¸ êµ¬ì¡°
src/main/java/com/example/sk_pjt2_back_chat/
â”œâ”€â”€ config/
â”‚   â”œâ”€â”€ SecurityConfig.java         # Spring Security ì„¤ì •
â”‚   â””â”€â”€ WebSocketConfig.java        # WebSocket & STOMP ì„¤ì •
â”œâ”€â”€ controller/
â”‚   â”œâ”€â”€ ChatController.java         # ì±„íŒ… ë©”ì‹œì§€ ì²˜ë¦¬
â”‚   â”œâ”€â”€ RoomController.java         # ì±„íŒ…ë°© ê´€ë¦¬
â”‚   â””â”€â”€ InquiryController.java      # ë¬¸ì˜ ê¸°ëŠ¥
â”œâ”€â”€ dto/
â”‚   â”œâ”€â”€ ChatDto.java               # ì±„íŒ… ë©”ì‹œì§€ DTO
â”‚   â”œâ”€â”€ RoomDto.java               # ì±„íŒ…ë°© ì •ë³´ DTO
â”‚   â””â”€â”€ RoomUserDto.java           # ë°© ì°¸ì—¬ì DTO
â”œâ”€â”€ entity/
â”‚   â”œâ”€â”€ Chat.java                  # ì±„íŒ… ë©”ì‹œì§€ ì—”í‹°í‹°
â”‚   â”œâ”€â”€ Room.java                  # ì±„íŒ…ë°© ì—”í‹°í‹°
â”‚   â””â”€â”€ RoomUser.java              # ë°© ì°¸ì—¬ì ì—”í‹°í‹°
â”œâ”€â”€ service/
â”‚   â”œâ”€â”€ ChatService.java           # ì±„íŒ… ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§
â”‚   â”œâ”€â”€ RoomService.java           # ì±„íŒ…ë°© ê´€ë¦¬ ë¡œì§
â”‚   â””â”€â”€ InquiryService.java        # ë¬¸ì˜ ì²˜ë¦¬ ë¡œì§
â”œâ”€â”€ repository/
â”‚   â”œâ”€â”€ ChatRepository.java        # ì±„íŒ… ë°ì´í„° ì ‘ê·¼
â”‚   â”œâ”€â”€ RoomRepository.java        # ì±„íŒ…ë°© ë°ì´í„° ì ‘ê·¼
â”‚   â””â”€â”€ RoomUserRepository.java    # ì°¸ì—¬ì ë°ì´í„° ì ‘ê·¼
â””â”€â”€ interceptor/
    â””â”€â”€ StompInterceptor.java      # STOMP ì—°ê²° ì¸í„°ì…‰í„°
ğŸš€ ì£¼ìš” ê¸°ëŠ¥
ì‹¤ì‹œê°„ ì±„íŒ…

WebSocket + STOMP í”„ë¡œí† ì½œ ê¸°ë°˜ ì–‘ë°©í–¥ í†µì‹ 
ì‹¤ì‹œê°„ ë©”ì‹œì§€ ì „ì†¡ ë° ìˆ˜ì‹ 
ì ‘ì†ì ìƒíƒœ ê´€ë¦¬

ì±„íŒ…ë°© ê´€ë¦¬

1:1 ì±„íŒ…ë°© ìë™ ìƒì„±
ìƒí’ˆë³„ ì±„íŒ…ë°© êµ¬ë¶„
ì±„íŒ… íˆìŠ¤í† ë¦¬ ì €ì¥ ë° ì¡°íšŒ

í™•ì¥ ê°€ëŠ¥í•œ ì•„í‚¤ï¿½ecture

Kafkaë¥¼ í†µí•œ ë©€í‹° ì„œë²„ ë©”ì‹œì§€ ë™ê¸°í™”
Redis ê¸°ë°˜ ì„¸ì…˜ ê´€ë¦¬
ë§ˆì´í¬ë¡œì„œë¹„ìŠ¤ í˜¸í™˜ ì„¤ê³„

ë³´ì•ˆ & ì¸ì¦

Spring Security í†µí•©
JWT ê¸°ë°˜ ì‚¬ìš©ì ì¸ì¦ ì¤€ë¹„
CORS ì„¤ì •ìœ¼ë¡œ ì•ˆì „í•œ í†µì‹ 

ğŸ“š API ë¬¸ì„œ
ì±„íŒ… ê´€ë ¨
http# ì±„íŒ…ë°© ë©”ì‹œì§€ ì¡°íšŒ
GET /chat/room/{roomUUID}

# ì›¹ì†Œì¼“ ì—°ê²°
WebSocket: /ws-stomp
ì±„íŒ…ë°© ê´€ë¦¬
http# ì±„íŒ…ë°© ìƒì„±
POST /room/create
Headers: X-Auth-User: {userId}
Params: user={targetUser}&name={productName}

# ì‚¬ìš©ì ì±„íŒ…ë°© ëª©ë¡ ì¡°íšŒ
GET /room/list
Headers: X-Auth-User: {userId}

# ì±„íŒ…ë°© ì…ì¥
GET /room/enter/{roomUUID}
Headers: X-Auth-User: {userId}

# ì±„íŒ…ë°© ì‚­ì œ
DELETE /room/delete/{roomUUID}
WebSocket ë©”ì‹œì§€
javascript// êµ¬ë… (ë©”ì‹œì§€ ìˆ˜ì‹ )
stompClient.subscribe('/sub/chat/room/{roomUUID}', callback);

// ë°œí–‰ (ë©”ì‹œì§€ ì „ì†¡)
stompClient.send('/pub/room/{roomUUID}/message', {}, JSON.stringify({
    roomUUID: 'room-id',
    sender: 'user-id',
    content: 'ë©”ì‹œì§€ ë‚´ìš©'
}));
ğŸ³ Docker í™˜ê²½ ì„¤ì •
í•„ìˆ˜ ì„œë¹„ìŠ¤
yaml# docker-compose.ymlì— í¬í•¨ëœ ì„œë¹„ìŠ¤ë“¤
services:
  - zookeeper    # Kafka í´ëŸ¬ìŠ¤í„° ê´€ë¦¬
  - kafka        # ë©”ì‹œì§€ í
  - mongodb      # NoSQL (ì˜ˆë¹„ìš©)
ì‹¤í–‰ ëª…ë ¹ì–´
bash# Docker í™˜ê²½ ì‹œì‘
docker-compose up -d

# ì• í”Œë¦¬ì¼€ì´ì…˜ ë¹Œë“œ ë° ì‹¤í–‰
./gradlew clean build -x test
java -jar build/libs/sk_pjt2_back_chat-0.0.1-SNAPSHOT.jar
âš™ï¸ í™˜ê²½ ì„¤ì •
application.yml ì˜ˆì‹œ
yamlspring:
  datasource:
    url: jdbc:mysql://localhost:3306/sk_pjt2_chat
    username: your_username
    password: your_password
  
  kafka:
    bootstrap-servers: localhost:9092
    consumer:
      group-id: team5
  
  redis:
    host: localhost
    port: 6379
  
  mail:
    host: smtp.gmail.com
    username: your_email@gmail.com
    password: your_app_password
í™˜ê²½ ë³€ìˆ˜
GitHub Actions ë°°í¬ë¥¼ ìœ„í•œ í•„ìˆ˜ ì‹œí¬ë¦¿:

EC2_HOST - EC2 ì„œë²„ ì£¼ì†Œ
EC2_USER - EC2 ì‚¬ìš©ìëª…
EC2_KEY - EC2 SSH í‚¤
APPLICATION_YML - ì• í”Œë¦¬ì¼€ì´ì…˜ ì„¤ì • íŒŒì¼

ğŸ”§ ê°œë°œ & ë°°í¬
ë¡œì»¬ ê°œë°œ
bash# 1. ì €ì¥ì†Œ í´ë¡ 
git clone <repository-url>
cd sk_pjt2_back_chat

# 2. Docker ì„œë¹„ìŠ¤ ì‹œì‘
docker-compose up -d

# 3. ì• í”Œë¦¬ì¼€ì´ì…˜ ì‹¤í–‰
./gradlew bootRun
í”„ë¡œë•ì…˜ ë°°í¬

main ë¸Œëœì¹˜ push ì‹œ GitHub Actionsê°€ ìë™ìœ¼ë¡œ EC2ì— ë°°í¬
í¬íŠ¸ 8070ì—ì„œ ì„œë¹„ìŠ¤ ì‹¤í–‰
ë¬´ì¤‘ë‹¨ ë°°í¬ ì§€ì›

ğŸ”„ ì±„íŒ… í”Œë¡œìš°

ì±„íŒ…ë°© ìƒì„±: êµ¬ë§¤ìê°€ íŒë§¤ìì—ê²Œ ì±„íŒ… ìš”ì²­
WebSocket ì—°ê²°: í´ë¼ì´ì–¸íŠ¸ê°€ /ws-stomp ì—”ë“œí¬ì¸íŠ¸ë¡œ ì—°ê²°
ë°© êµ¬ë…: /sub/chat/room/{roomUUID} í† í”½ êµ¬ë…
ë©”ì‹œì§€ ì „ì†¡: /pub/room/{roomUUID}/messageë¡œ ë©”ì‹œì§€ ë°œí–‰
Kafka ì²˜ë¦¬: ë©”ì‹œì§€ê°€ Kafkaë¥¼ í†µí•´ ëª¨ë“  ì—°ê²°ëœ ì„œë²„ë¡œ ì „íŒŒ
ì‹¤ì‹œê°„ ìˆ˜ì‹ : êµ¬ë…ì¤‘ì¸ ëª¨ë“  í´ë¼ì´ì–¸íŠ¸ê°€ ë©”ì‹œì§€ ìˆ˜ì‹ 
ì´ë ¥ ì €ì¥: MySQLì— ì±„íŒ… ì´ë ¥ ì˜êµ¬ ì €ì¥

ğŸ“ TODO

 JWT ì¸ì¦ ì‹œìŠ¤í…œ ì™„ì „ í†µí•©
 MongoDB ì±„íŒ… ì €ì¥ì†Œ ë§ˆì´ê·¸ë ˆì´ì…˜
 íŒŒì¼ ì²¨ë¶€ ê¸°ëŠ¥ ì¶”ê°€
 ì½ìŒ í‘œì‹œ ê¸°ëŠ¥
 ì±„íŒ…ë°© ì•Œë¦¼ ì„¤ì •
 ë©”ì‹œì§€ ê²€ìƒ‰ ê¸°ëŠ¥

ğŸ‘¥ ê¸°ì—¬ì

ê¹€ë¯¼ì„ - ì£¼ìš” ê°œë°œì

ğŸ“„ ë¼ì´ì„ ìŠ¤
This project is private and confidential.

SK PJT2 Re:Use Team | ì‹¤ì‹œê°„ ì¤‘ê³ ê±°ë˜ì˜ ìƒˆë¡œìš´ ê²½í—˜
